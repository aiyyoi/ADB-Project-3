'''
Aprioi logic in Figure 1 from reference
'''